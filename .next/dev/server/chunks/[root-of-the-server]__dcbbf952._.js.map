{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/hp/Downloads/scalable-web-app/lib/auth.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from \"jose\"\nimport { cookies } from \"next/headers\"\nimport type { JWTPayload } from \"./types\"\n\nconst JWT_SECRET = new TextEncoder().encode(process.env.JWT_SECRET || \"your-secret-key-change-in-production\")\nconst TOKEN_NAME = \"auth-token\"\n\nexport async function createToken(payload: JWTPayload): Promise<string> {\n  const token = await new SignJWT(payload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(\"7d\")\n    .sign(JWT_SECRET)\n\n  return token\n}\n\nexport async function verifyToken(token: string): Promise<JWTPayload | null> {\n  try {\n    const verified = await jwtVerify(token, JWT_SECRET)\n    return verified.payload as JWTPayload\n  } catch (error) {\n    return null\n  }\n}\n\nexport async function setAuthCookie(token: string) {\n  const cookieStore = await cookies()\n  cookieStore.set(TOKEN_NAME, token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    maxAge: 60 * 60 * 24 * 7, // 7 days\n    path: \"/\",\n  })\n}\n\nexport async function getAuthToken(): Promise<string | null> {\n  const cookieStore = await cookies()\n  const token = cookieStore.get(TOKEN_NAME)\n  return token?.value || null\n}\n\nexport async function removeAuthCookie() {\n  const cookieStore = await cookies()\n  cookieStore.delete(TOKEN_NAME)\n}\n\nexport async function getCurrentUser(): Promise<JWTPayload | null> {\n  const token = await getAuthToken()\n  if (!token) return null\n\n  return await verifyToken(token)\n}\n\nexport async function requireAuth(): Promise<JWTPayload> {\n  const user = await getCurrentUser()\n  if (!user) {\n    throw new Error(\"Unauthorized\")\n  }\n  return user\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AAAA;AACA;;;AAGA,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI;AACtE,MAAM,aAAa;AAEZ,eAAe,YAAY,OAAmB;IACnD,MAAM,QAAQ,MAAM,IAAI,wPAAO,CAAC,SAC7B,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,MAClB,IAAI,CAAC;IAER,OAAO;AACT;AAEO,eAAe,YAAY,KAAa;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,4PAAS,EAAC,OAAO;QACxC,OAAO,SAAS,OAAO;IACzB,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,cAAc,KAAa;IAC/C,MAAM,cAAc,MAAM,IAAA,iTAAO;IACjC,YAAY,GAAG,CAAC,YAAY,OAAO;QACjC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;QACvB,MAAM;IACR;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,iTAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC;IAC9B,OAAO,OAAO,SAAS;AACzB;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,iTAAO;IACjC,YAAY,MAAM,CAAC;AACrB;AAEO,eAAe;IACpB,MAAM,QAAQ,MAAM;IACpB,IAAI,CAAC,OAAO,OAAO;IAEnB,OAAO,MAAM,YAAY;AAC3B;AAEO,eAAe;IACpB,MAAM,OAAO,MAAM;IACnB,IAAI,CAAC,MAAM;QACT,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/hp/Downloads/scalable-web-app/proxy.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport type { NextRequest } from \"next/server\"\nimport { verifyToken } from \"@/lib/auth\"\n\nexport async function proxy(request: NextRequest) {\n  const { pathname } = request.nextUrl\n\n  // Protected routes that require authentication\n  const protectedRoutes = [\"/dashboard\"]\n  const isProtectedRoute = protectedRoutes.some((route) => pathname.startsWith(route))\n\n  if (isProtectedRoute) {\n    const token = request.cookies.get(\"auth-token\")?.value\n\n    if (!token) {\n      return NextResponse.redirect(new URL(\"/login\", request.url))\n    }\n\n    const payload = await verifyToken(token)\n    if (!payload) {\n      return NextResponse.redirect(new URL(\"/login\", request.url))\n    }\n  }\n\n  // Redirect to dashboard if already authenticated\n  const authRoutes = [\"/login\", \"/signup\"]\n  const isAuthRoute = authRoutes.includes(pathname)\n\n  if (isAuthRoute) {\n    const token = request.cookies.get(\"auth-token\")?.value\n    if (token) {\n      const payload = await verifyToken(token)\n      if (payload) {\n        return NextResponse.redirect(new URL(\"/dashboard\", request.url))\n      }\n    }\n  }\n\n  return NextResponse.next()\n}\n\nexport const config = {\n  matcher: [\"/dashboard/:path*\", \"/login\", \"/signup\"],\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAEA;;;AAEO,eAAe,MAAM,OAAoB;IAC9C,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,+CAA+C;IAC/C,MAAM,kBAAkB;QAAC;KAAa;IACtC,MAAM,mBAAmB,gBAAgB,IAAI,CAAC,CAAC,QAAU,SAAS,UAAU,CAAC;IAE7E,IAAI,kBAAkB;QACpB,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe;QAEjD,IAAI,CAAC,OAAO;YACV,OAAO,qTAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;QAEA,MAAM,UAAU,MAAM,IAAA,iKAAW,EAAC;QAClC,IAAI,CAAC,SAAS;YACZ,OAAO,qTAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;IACF;IAEA,iDAAiD;IACjD,MAAM,aAAa;QAAC;QAAU;KAAU;IACxC,MAAM,cAAc,WAAW,QAAQ,CAAC;IAExC,IAAI,aAAa;QACf,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe;QACjD,IAAI,OAAO;YACT,MAAM,UAAU,MAAM,IAAA,iKAAW,EAAC;YAClC,IAAI,SAAS;gBACX,OAAO,qTAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;YAChE;QACF;IACF;IAEA,OAAO,qTAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAqB;QAAU;KAAU;AACrD"}}]
}